<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>คำนวณ BMI · เว็บแอป</title>
  <meta name="description" content="เว็บแอปคำนวณค่าดัชนีมวลกาย (BMI) รองรับเกณฑ์ WHO และเอเชีย ใช้งานบนมือถือได้" />
  <style>
    :root{
      --bg:#0f172a;          /* slate-900 */
      --card:#111827;        /* gray-900 */
      --muted:#94a3b8;       /* slate-400 */
      --text:#e5e7eb;        /* gray-200 */
      --primary:#22d3ee;     /* cyan-400 */
      --accent:#a78bfa;      /* violet-400 */
      --ok:#34d399;          /* emerald-400 */
      --warn:#fbbf24;        /* amber-400 */
      --bad:#fb7185;         /* rose-400 */
      --ring: 0 0 0 3px rgba(34,211,238,.25);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 600px at 20% -10%, rgba(167,139,250,.18), transparent 70%), linear-gradient(180deg, #0b1225, #0f172a);color:var(--text);font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;}
    .container{max-width:980px;margin:0 auto;padding:24px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:16px}
    header h1{font-size:clamp(22px,4vw,34px);margin:0;font-weight:800;letter-spacing:.2px}
    header .sub{color:var(--muted);font-size:.95rem}

    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media (min-width:900px){.grid{grid-template-columns:1.1fr .9fr}}

    .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.06);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:18px}
    .card h2{margin:0 0 8px;font-size:1.1rem}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

    label{display:block;margin:10px 0 6px;color:var(--muted);font-weight:600}
    input[type="number"], select{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:#0b1225;color:var(--text);outline:none}
    input[type="number"]:focus, select:focus{box-shadow:var(--ring);border-color:rgba(34,211,238,.4)}

    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{border:1px solid rgba(255,255,255,.12);background:#0b1225;color:var(--text);padding:11px 14px;border-radius:12px;cursor:pointer;font-weight:700}
    .btn.primary{background:linear-gradient(90deg, var(--primary), var(--accent));color:#0b1225;border:none}
    .btn:active{transform:translateY(1px)}

    .result{display:grid;gap:8px}
    .bmi-number{font-size:clamp(24px,5vw,40px);font-weight:900}
    .tag{display:inline-block;padding:.25rem .6rem;border-radius:999px;font-weight:800}
    .tag.ok{background:rgba(52,211,153,.15);color:var(--ok);border:1px solid rgba(52,211,153,.45)}
    .tag.warn{background:rgba(251,191,36,.12);color:var(--warn);border:1px solid rgba(251,191,36,.45)}
    .tag.bad{background:rgba(251,113,133,.12);color:var(--bad);border:1px solid rgba(251,113,133,.45)}

    .bar{position:relative;height:20px;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.12);background:linear-gradient(90deg, #60a5fa, #34d399 45%, #f59e0b 70%, #ef4444 95%)}
    .pointer{position:absolute;top:-4px;width:2px;height:28px;background:white;box-shadow:0 0 0 2px rgba(255,255,255,.4);left:0;border-radius:2px}
    .scale{display:flex;justify-content:space-between;font-size:.8rem;color:var(--muted);margin-top:6px}

    .tip{color:var(--muted);font-size:.95rem}
    .muted{color:var(--muted)}
    .range-bad{color:var(--bad)} .range-warn{color:var(--warn)} .range-ok{color:var(--ok)}

    .history ul{list-style:none;padding:0;margin:8px 0 0}
    .history li{display:flex;justify-content:space-between;gap:8px;padding:8px 10px;border:1px dashed rgba(255,255,255,.12);border-radius:12px;margin-top:8px}
    .history .small{font-size:.9rem;color:var(--muted)}

    footer{margin-top:24px;text-align:center;color:var(--muted);font-size:.9rem}
    a{color:var(--primary);text-decoration:none}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>ตัวคำนวณ BMI <span class="sub">(ดัชนีมวลกาย)</span></h1>
        <div class="sub">รองรับเกณฑ์ <b>WHO</b> และ <b>เอเชีย</b> · ใช้งานได้บนมือถือ</div>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: FORM -->
      <section class="card" aria-labelledby="calc-title">
        <h2 id="calc-title">กรอกข้อมูล</h2>
        <div class="row">
          <div>
            <label for="height">ส่วนสูง (ซม.)</label>
            <input id="height" type="number" min="50" max="250" step="0.1" placeholder="เช่น 170" />
          </div>
          <div>
            <label for="weight">น้ำหนัก (กก.)</label>
            <input id="weight" type="number" min="10" max="300" step="0.1" placeholder="เช่น 65" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="standard">เกณฑ์การแปลผล</label>
            <select id="standard" aria-label="มาตรฐานการแปลผล">
              <option value="asian">เอเชีย (เหมาะกับคนไทย)</option>
              <option value="who">WHO (สากล)</option>
            </select>
          </div>
          <div>
            <label for="dec">ทศนิยม</label>
            <select id="dec">
              <option>1</option>
              <option selected>2</option>
              <option>3</option>
            </select>
          </div>
        </div>

        <div class="btns">
          <button class="btn primary" id="calcBtn">คำนวณ BMI</button>
          <button class="btn" id="clearBtn" type="button">ล้างค่า</button>
        </div>
      </section>

      <!-- RIGHT: RESULT -->
      <section class="card" aria-labelledby="result-title">
        <h2 id="result-title">ผลลัพธ์</h2>
        <div class="result" id="resultBox" aria-live="polite">
          <div class="muted">กรอกข้อมูลด้านซ้ายแล้วกดคำนวณ</div>
        </div>
        <div style="margin-top:12px">
          <div class="bar" aria-hidden="true">
            <div class="pointer" id="pointer" style="left:0%"></div>
          </div>
          <div class="scale" id="scale">
            <!-- filled by JS with tick labels -->
          </div>
        </div>
        <p class="tip" id="tip"></p>
      </section>
    </div>

    <!-- HISTORY -->
    <section class="card history" aria-labelledby="history-title">
      <h2 id="history-title">ประวัติการคำนวณล่าสุด</h2>
      <div class="small">บันทึกไว้บนเครื่องของคุณเท่านั้น (localStorage)</div>
      <ul id="history"></ul>
    </section>

    <footer>
      ทำด้วย ❤ เพื่อการศึกษา · ต้องการฟีเจอร์เพิ่มเติมแจ้งได้เลย
    </footer>
  </div>

  <script>
    // เกณฑ์การแปลผลสองแบบ
    const STANDARDS = {
      asian: {
        name: "เอเชีย",
        // ขอบเขตตัวเลขสำหรับช่วง (ปลายช่วงรวม): [upper, label, tag]
        bands: [
          [18.5, "น้ำหนักน้อย", "bad"],
          [22.9, "ปกติ", "ok"],
          [24.9, "ท้วม/เสี่ยง", "warn"],
          [29.9, "อ้วน ระดับ 1", "bad"],
          [Infinity, "อ้วน ระดับ 2", "bad"],
        ],
        normalRange: [18.5, 22.9],
        ticks: [16,18.5,23,25,30,35]
      },
      who: {
        name: "WHO",
        bands: [
          [18.5, "น้ำหนักน้อย", "bad"],
          [24.9, "ปกติ", "ok"],
          [29.9, "เกินเกณฑ์", "warn"],
          [34.9, "อ้วน ระดับ 1", "bad"],
          [39.9, "อ้วน ระดับ 2", "bad"],
          [Infinity, "อ้วน ระดับ 3", "bad"],
        ],
        normalRange: [18.5, 24.9],
        ticks: [16,18.5,25,30,35,40]
      }
    };

    const el = id => document.getElementById(id);
    const height = el('height');
    const weight = el('weight');
    const standardSel = el('standard');
    const decSel = el('dec');
    const resultBox = el('resultBox');
    const pointer = el('pointer');
    const scale = el('scale');
    const tip = el('tip');
    const historyList = el('history');

    function round(val, places){
      const p = Math.pow(10, places);
      return Math.round(val * p) / p;
    }

    function calcBMI(hCm, wKg){
      const hM = hCm / 100;
      return wKg / (hM * hM);
    }

    function bandFor(bmi, std){